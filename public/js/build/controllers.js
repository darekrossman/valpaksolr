// Generated by CoffeeScript 1.6.2
(function() {
  var module;

  module = angular.module('app.controllers', []);

  module.controller('HomeController', ['$scope', function($scope) {}]);

  module.controller('SearchController', [
    '$scope', '$location', 'ListingFilter', function($scope, $location, ListingFilter) {
      $scope.listingFilter = ListingFilter;
      return $scope.queryKeyword = function() {
        $location.url("/search/?keywords=" + ListingFilter.searchText);
        return angular.element('.search-input').blur();
      };
    }
  ]);

  module.controller('ListingController', [
    '$scope', '$location', '$route', 'KeywordListingLoader', 'CategoryListingsLoader', 'ListingFilter', function($scope, $location, $route, KeywordListingLoader, CategoryListingsLoader, ListingFilter) {
      var getListings;

      ListingFilter.loading = true;
      $scope.listingFilter = ListingFilter;
      $scope.selectedCategory = '';
      $scope.currentSearch = $route.current.params.keywords;
      if ($route.current.params.keywords) {
        getListings = KeywordListingLoader();
        ListingFilter.resultsLabel = "Showing results for: '" + $route.current.params.keywords + "'";
      } else if ($route.current.params.cat) {
        getListings = CategoryListingsLoader();
        ListingFilter.resultsLabel = $route.current.params.cat;
      }
      getListings.then(function(listings) {
        console.log(listings);
        $scope.listings = [listings.keywordCouponsList, listings.keywordGroceryList, listings.keywordSdcCouponsList, listings.keywordDealsList];
        $scope.couponListings = listings.keywordCouponsList;
        $scope.selectedDetail = $scope.listings.selectedDetail;
        $scope.dealsListings = listings.keywordDealsList;
        $scope.groceryListings = listings.keywordGroceryList;
        $scope.sdcListings = listings.keywordSdcCouponsList;
        ListingFilter.loading = false;
        return $scope.toggleDeviceNav = function() {
          return $('.body-wrap').addClass('slideOutRight');
        };
      });
      $scope.getLogoSrc = function(logo) {
        if (this.listing.slugTypeId !== null) {
          if (this.listing.logoImageFileName) {
            return 'http://vptst.valpak.com/img/print/' + this.listing.logoImageFileName;
          } else {
            return '/img/defaultLogo.png';
          }
        } else {
          if (this.listing.logoImageFileName) {
            return this.listing.logoImageFileName;
          } else if (this.listing.dealImageURL) {
            return this.listing.dealImageURL;
          } else {
            return '/img/defaultLogo.png';
          }
        }
      };
      return $scope.getBusinessProfile = function(profileId) {
        return $location.url("/listing/profile/" + profileId);
      };
    }
  ]);

  module.controller('BusinessProfileController', [
    '$scope', '$location', '$route', 'profile', function($scope, $location, $route, profile) {
      $scope.profile = profile;
      $scope.businessGeo = profile.selectedAddressOffer.geoCoordinates;
      return console.log(profile);
    }
  ]);

}).call(this);
